# 거래후기(한 개) 조회

거래후기는 모두가 판매자, 구매자 모두 볼 수 있다.
또란 거래후기를 볼 수 있는 페이지는(직접 클릭하여 보는 부분, 해당 api를 이용하여 구매후기를 조회하는 부분을 의미함)
내거래정보와 채팅방 뿐이다. 채팅방의 경우는 판매자의 입장에서 어떤 사람이 내 물건에 대해서 후기를 남겼는 지 조회할 수 있다.

결론은
채팅방에서 내가 남긴 거래후기(구매자입장)를 볼때나 "닉네임"이 남긴 거래후기 보기(판매자입장)를 눌러 남긴 구매후기를 볼 떄
아래와 같은 엔드포인트로 거래후기 정보를 조회한다.
myItem 의 구매물품 중 구매후기를 작성한 물건에 한해서 개별물품의 [거래후기보기] 를 클릭시 아래의 엔드포인트로
서버로 요청해 해당 물건의 거래후기를 볼 수 있다.

다만,
거래후기역시 상대방의 어떤 상태에 놓여있는 가에 따라서 응답값이 달리 내려온다.
즉, 판매자/구매자 상관없이 상대방이 차단/유저제재/탈퇴 또는 해당 물건이 블라인드조치/삭제 되었을 경우에는 구매후기를 볼 수 없는 데(물건에 종속)
따라서 이 경우에 해당되면 예외 응답값을 내려주며 구매후기는 더 이상 조회불가능 하며 그에 따른 예외 응답값을 내려주고 있다.



### 수정사항 3.18 예외사항 추가 
거래후기 조회시 거래조회를 하려고 할 때 구매한 물건이 블라인드 처리되었는 지 삭제되었는지
또는 상대방이 유저제재/차단/탈퇴 되었는 지 상태에 따라 다른 예외응답값이 내려온다.

총 5개가 있으며 해당 예외값이 올때는 적절한 UI 처리를 하면 될 듯하다.
가령 채팅방에서 조회해서 해당 에러가 뜰 경우는 채팅방의 UI를 비활성화 처리하면 될 것이고, 내거래정보에서 구매물건 쪽에서 조회하려고 하는 데 해당
에러가 뜬다면 특별한 조치를 하지 않거나 아니면 새로고침을 시키는 방법이 있을 것이다.

1. 상대방(판매자)이 탈퇴했을 경우
2. 거래후기 조회시 물건이 삭제되었을 경우
3. 거래후기 조회시 물건이 관리자에 의해 블라인드 처리되었을 때
4. (판매자/구매자 입장) 상대방(여기서 말하는 상대방은, 판매자입장이면 구매후기조회를 클릭할 때 후기를 남긴 사람을 뜻하고 구매자입장이면 구매후기를 남긴 물건의 소유자를 뜻한다.)이 이용제재받고 있을 때
   

--- 
아래의 5,6번은 무시하셔도 됩니다.

5. (판매자/구매자 입장) 차단관계에 있을 때(무시하셔도 됩니다.)
6. (판매자/구매자 입장) 모두 차단관계일 때(나도 차단, 상대방도 나를 차단 -> 3번을 따라감)(무시하셔도 됩니다)

자세한 응답값은 아래에 나와있다.



**URL** : `/api/product/{product-id}/comment`

**Method** : `GET`

**Authentication required** : `yes`

**Data** : `None`

## Success Responses

___

**Code** : `200 OK`

**Content**

`message`: 응답 메시지

`status`: 응답 상태

`data`: 구매자 정보 및 거래 후기 내용

​		`review_nickname`: 구매자 닉네임

​		`review_comment`: 구매자 거래 후기 내용

​		`review_date`: 구매자 거래 후기 작성한 날짜

**example**

```json
{
    "message": "product comment",
    "status": 200,
    "data": {
        "review_nickname": "fgh0296",
        "review_comment": "정말정말 친절하십니다!! 또 거래하고 싶을 정도 입니다!",
        "review_date": "2021-01-15T23:59:51"
    }
}
```

## 예외사항 (success response) 총5가지가 있다.

1. 상대방이 탈퇴했을 경우
2. 거래후기 조회시 물건이 삭제되었을 경우
3. 거래후기 조회시 물건이 관리자에 의해 블라인드 처리되었을 때
4. 상대방이 이용제재를 받고 있을 때

--- 
아래의 5,6 번의 경우는 무시하셔도 됩니다. (이런 경우는 없습니다.)
5. 차단관계에 있을 때 (무시하셔도 됩니다.)
6. 서로 모두 차단관계일 때(나도 차단, 상대방도 나를 차단 -> 3번을 따라감) (무시하셔도 됩니다.)

### 1.상대방이 탈퇴했을 경우

```json

{
    "statusCode": 404,
    "timestamp": "2021-03-18T05:42:46.242+00:00",
    "message": "탈퇴한 유저의 거래후기는 조회할 수 없습니다.",
    "description": "uri=/api/product/20/comment"
}

```


### 2.거래후기 조회시 물건이 삭제되었을 경우

```json

{
    "statusCode": 404,
    "timestamp": "2021-03-18T05:42:46.242+00:00",
    "message": "해당 중고물품은 삭제처리되었습니다.",
    "description": "uri=/api/product/20/comment"
}

```

### 2. 거래후기 조회시 물건이 관리자에 의해 블라인드 처리되었을 때

```json

{
    "statusCode": 404,
    "timestamp": "2021-03-18T05:42:46.242+00:00",
    "message": "해당 중고물품은 관리자에 의해 비공개 처리되었습니다.",
    "description": "uri=/api/product/20/comment"
}

```

### 3. 상대방이 이용제재받고 있을 때


```json

{
    "statusCode": 400,
    "timestamp": "2021-03-18T05:42:46.242+00:00",
    "message": "이용제재를 받고 있는 유저의 거래후기는 조회할 수 없습니다.",
    "description": "uri=/api/product/20/comment"
}

```








---
아래의 4,5번은 무시하셔도 됩니다! 왜냐하면 애초에 이런 상황은 존재하지 않습니다.
거래후기를 조회할 수 있다는 것은 이미 해당 물건에 대해서 거래완료를 했다는 것이고
거래완료를 하면 애초에 서로 차단을 할 수 없기 때문입니다. 그렇기때문에 4,5번과 같은 상황은 일어나지 않습니다.
무시하셔도 됩니다.

### 5.차단관계에 있을 때

1) 구매자입장에서 내가 올린 구매후기를 보는 경우

1_1 내(구매자)가 상대방(판매자)을 차단했을 경우

```json

{
  "statusCode": 400,
  "timestamp": "2021-03-18T05:42:46.242+00:00",
  "message": "차단한 유저에 대한 거래후기를 조회할 수 없습니다.",
  "description": "uri=/api/product/20/comment"
}

```


1_2 상대방(판매자)이 나(구매자)를 차단했을 경우

```json

{
  "statusCode": 400,
  "timestamp": "2021-03-18T05:42:46.242+00:00",
  "message": "해당 유저에게 차단 당하여 거래후기를 조회할 수 없습니다.",
  "description": "uri=/api/product/20/comment"
}

```

---


2) 판매자입장에서 구매자가 올린 구매후기를 보는 경우


2_1 내(판매자)가 상대방(구매자)를 차단했을 경우

```json

{
  "statusCode": 400,
  "timestamp": "2021-03-18T05:42:46.242+00:00",
  "message": "차단한 유저에 대한 거래후기를 조회할 수 없습니다.",
  "description": "uri=/api/product/20/comment"
}

```



2_2 상대방(구매자)이 나를 차단했을 경우

```json

{
  "statusCode": 400,
  "timestamp": "2021-03-18T05:42:46.242+00:00",
  "message": "해당 유저에게 차단당하여 거래후기를 조회할 수 없습니다.",
  "description": "uri=/api/product/20/comment"
}

```

### 6.(판매자/구매자 입장) 모두 차단관계일 때(나도 차단, 상대방도 나를 차단 -> 3번을 따라감)

이 경우에는 4번의 1번 구매자입장에서 내가 올린 구매후기를 보는 경우를 따라갑니다. 따라서 클라이언트는 그에 맞게 조치를 취하시면 됩니다.