# 물건에 대해서 채팅으로 거래한 이력이 있는 지 조회하기 기능

*설명

로그인 후 물건 개별 정보가 있는 페이지에서(onepick) 채팅으로 거래하기 클릭 시 내가 현재 해당 물건에 대해서 채팅으로 거래한 이력이 있는 지 확인한다.

만약 해당 물건에 대해서 채팅으로 거래한 이력이 있다면 "해당 물건에 대해서 채팅으로 거래한 이력이 있습니다. 채팅방에서 확인하세요!" 라고 클라이언트는 UI로 보여줘야 할 것이고 사용자를 채팅방으로 가게끔 유도한다.

혹은 거래한 이력이 없다면 이전처럼 채팅방 UI가 나오고 채팅을 할 수 있는 상황이 된다.



### request param(path)
`productId` : 고유 물건아이디

### success response body(json)

1) 해당 물건에 대해서 채팅이력이 있는 경우

`status` : 응답코드,

`message` : 응답메시지

`data` : 이력유무 데이터

---

`history_room_id` : 채팅방 아이디(optional, 1,2번의 사례의 경우 포함됨)

`history_product_id` : 물건번호(optional, 1,2번의 사례의 경우 포함됨)

`isExisted` : 채팅이력 존재유무,

`leave` : 채팅방 나감유무



### 1. 채팅으로거래하기 클릭시, 해당물건에 대해서 채팅방이 있고 나가지 않았을 경우

```json

{
    "message": "이전에 채팅거래했는지 조회",
    "status": 200,
    "data": {
        "history_room_id": 422,
        "history_product_id": 4,
        "existed": true,
        "leave": false
    }
}

```



### 2. 채팅으로거래하기 클릭시, 해당물건에 대해서 채팅방은 있지만(채팅 이력은 있지만) 나갔을 경우

```json

{
    "message": "이전에 채팅거래했는지 조회",
    "status": 200,
    "data": {
        "history_room_id": 422,
        "history_product_id": 4,
        "existed": true,
        "leave": true
    }
}


```


### 3. 채팅으로 거래하기 클릭시, 해당물건에 대해서 채팅한 이력이 없을 경우


````json

{
    "message": "이전에 채팅거래했는지 조회",
    "status": 200,
    "data": {
        "existed": false,
        "leave": false
    }
}


````



## 예외의 경우(클라이언트가 해야할 일 )

## 결론
**해당예외의 경우가 나오면 채팅방 UI를 띄워주는 부분까지 안가면 된다!!
그리고 1, 2, 3, 4 의 경우에는 애초에 이 공간에 들어오면 안되는 상황이므로 인덱스 페이지로 이용자를
강제 이동시킨다.**


1. 새롭게 채팅하려고 하는 유저가 **삭제, 존재하지않은** 물건에 대해서 요청하려고 할 때
2. 새롭게 채팅하려고 하는 유저가 **블라인드 처리** 된 물건에 대해서 요청하려고 할 때
3. 새롭게 채팅하려고 하는 유저가 **탈퇴한 유저** 의 물건에 대해서 요청하려고 할 때
4. 새롭게 채팅하려고 하는 유저가 **이용제재** 당한 유저의 물건에 대해서 요청하려고 할 때