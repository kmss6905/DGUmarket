---
REST API - Chat created by MS (21-01-15)
---

# 신고하기

특정 유저 또는 물건을 신고할 수 있는 기능이다. 
개별 물건페이지에서 물건에대해서 신고를 할 수도 있고
채팅방 혹은 채팅방 목록 화면에서도 사용자에 대해서 신고를 할 수 있다.


### 4.13 추가된 예외 응답에 대한 처리 추가
=> 결론 : (자세한 건 아래에 있음) 예외 응답이 올 경우, 클라이언트는 다시 신고하기를 해달라는 내용의 팝업창을 띄워주면 된다.


신고하기를 클릭하면 세부적인 **카테고리**를 선택하고
1. 욕설 및 비방등의 언어폭력
2. 성희롱
3. 전문판매업자 의심
4. 광고 및 홍보성 글
5. 사기피해 및 사기의심
6. 판매 금지 품목 업로드
7. 기타
이후 구체적인 **신고내용**을 작성하여 아래의 엔드포인트로 서버에 요청한다.
 

개별 물건페이지에서 신고하기 버튼을 눌러 신고를 할 경우와 채팅방 혹은 채팅방 목록화면에서 사용자에 대해
신고하는 경우가 요청하게 되는 request body 의 형태가 다르다.

**결론 : 물건페이지 와 채팅방 혹은 채팅목록에서 신고하기 요청을 할 경우 request body 의 형태가 다르니 유의 할 것** 


### 1. 개별물건페이지 에서 신고하기를 할 경우 

**URL** : `/report` 

**Method** : `POST`

**Authentication required** : `yes`

**Data** :

`report_category_id` : 신고 카테고리 ID

`report_product_id` : 신고 물건 고유 ID (신고하기 클릭시 물건고유 ID를 참조해야함)

 `report_etc_reason` : 신고 상세 내용(추가적인 내용)
  

```json

{
	"report_category_id" : 1,  
	"report_product_id" : 3, 
	"report_etc_reason" : "혐오감을 조장하는 물건이 업로드되었어요"
}

```

## Success Responses

___
 
**Code** : `200 OK`

**Content**

Reported successfully




### 2. 채팅방 혹은 채팅목록에서 에서 신고하기를 할 경우


**URL** : `/report` 

**Method** : `POST`

**Authentication required** : `yes`

**Data** :

`report_category_id` : 신고 카테고리 ID

`report_room_id` : 채팅방 고유 ID (신고하기 클릭시 채팅방 고유 ID를 참조해야함)

 `report_etc_reason` : 신고 상세 내용(추가적인 내용)
  

```json

{
	"report_category_id" : 1,  
	"report_room_id" : 7, 
	"report_etc_reason" : "진짜 판매자분 욕설부터 해서 정말 심각합니다. 정신적 스트레스를 받고 있습니다. 대화보면 가관입니다."
}

```

## Success Responses

___
 
**Code** : `200 OK`

**Content**

Reported successfully



### 예외처리 ( 4.13 추가 )

서버에서 신고접수 처리 과정에서 문자메시지 발송 에러가 나는 경우
=> 현재의 신고 시스템은 클라이언트가 신고접수를 하게 되면 "신고가 접수되었다"라고 하는 문자메시지가 클라이언트에게 전송됩니다.
이때 이 과정에서 에러가 나는 경우에 응답받는 에러메시지 입니다.

[HTTP/1.1 200 OK]
// 알리고 서버에서 문자 전송 실패했을 경우는 'statusCode'가 0보다 작은 경우입니다. ()
// 'statusCode'가 0보다 작은 경우, 실패 사유를 확인할 수 있습니다.

사실 이 경우에는 "서버측 에러로 신고요청이 실패하였습니다. 다시 요청해 주세요." 라고 알려준다. 
클라이언트에게 알려줄 팝업창을 띄우면 된다.

```json

{
    "statusCode": "0 보다 작은 경우, (ex -1, -102, ..)",
    "timestamp": "2021-03-20T01:33:27.427+00:00",
    "message": "알리고 문자 전송 실패, 실패 사유 : '실패사유'",
    "requestPath": "/api/send-sms/verify-phone",
    "pathToMove": null
}

```


